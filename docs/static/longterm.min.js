class LMBase extends HTMLElement{#t=!1;connectedCallback(){this.#t||(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>this.#e(),{once:!0}):this.#e())}#e(){this.#t||(this.#t=!0,this.init())}init(){}disconnectedCallback(){this.cleanup()}cleanup(){}handleEvent(t){const e=this[`on${t.type}`];e&&e.call(this,t)}emit(t,e=null){return this.dispatchEvent(new CustomEvent(t,{bubbles:!0,composed:!0,cancelable:!0,detail:e}))}getBool(t){return this.hasAttribute(t)}setBool(t,e){e?this.setAttribute(t,""):this.removeAttribute(t)}$(t){return this.querySelector(t)}$$(t){return Array.from(this.querySelectorAll(t))}uid(){return Math.random().toString(36).slice(2,10)}}typeof window<"u"&&(window.LMBase=LMBase);class LMDialog extends LMBase{#t=null;static get observedAttributes(){return["open"]}init(){if(this.#t=this.$("dialog"),!this.#t){console.warn("lm-dialog: No <dialog> element found");return}this.#t.classList.add("animate-pop-in"),this.$$("[data-trigger]").forEach(t=>{t.addEventListener("click",this)}),this.$$("[data-close]").forEach(t=>{t.addEventListener("click",this)}),this.#t.addEventListener("click",this),this.#t.addEventListener("keydown",this),this.#t.addEventListener("close",this),this.hasAttribute("open")&&this.show()}attributeChangedCallback(t,e,s){t==="open"&&this.#t&&(s!==null?this.show():this.close())}onclick(t){const e=t.target;if(e.closest("[data-trigger]")){t.preventDefault(),this.show();return}if(e.closest("[data-close]")){t.preventDefault(),this.close();return}e===this.#t&&this.close()}onkeydown(t){t.key==="Escape"&&(t.preventDefault(),this.close())}onclose(){this.removeAttribute("open"),this.emit("lm-dialog-close")}show(){this.#t&&!this.#t.open&&(this.#t.showModal(),this.emit("lm-dialog-open"))}close(){this.#t&&this.#t.open&&(this.#t.setAttribute("data-state","closing"),setTimeout(()=>{this.#t.close(),this.#t.removeAttribute("data-state")},150))}get open(){return this.#t?.open??!1}set open(t){this.setBool("open",t)}}customElements.define("lm-dialog",LMDialog);class LMTabs extends LMBase{#t=[];#e=[];#s=0;init(){if(this.#t=this.$$('[role="tab"]'),this.#e=this.$$('[role="tabpanel"]'),this.#t.length===0||this.#e.length===0){console.warn("lm-tabs: Missing tab or tabpanel elements");return}this.#t.forEach((e,s)=>{const i=this.#e[s];if(!i)return;const o=e.id||`lm-tab-${this.uid()}`,a=i.id||`lm-panel-${this.uid()}`;e.id=o,i.id=a,e.setAttribute("aria-controls",a),i.setAttribute("aria-labelledby",o),e.addEventListener("click",this),e.addEventListener("keydown",this)});const t=this.#t.findIndex(e=>e.getAttribute("aria-selected")==="true");this.#i(t>=0?t:0)}onclick(t){const e=t.target.closest('[role="tab"]');if(e){const s=this.#t.indexOf(e);s>=0&&this.#i(s)}}onkeydown(t){const{key:e}=t;let s=this.#s;switch(e){case"ArrowLeft":case"ArrowUp":t.preventDefault(),s=this.#s-1,s<0&&(s=this.#t.length-1);break;case"ArrowRight":case"ArrowDown":t.preventDefault(),s=(this.#s+1)%this.#t.length;break;case"Home":t.preventDefault(),s=0;break;case"End":t.preventDefault(),s=this.#t.length-1;break;default:return}this.#i(s),this.#t[s].focus()}#i(t){this.#t.forEach((e,s)=>{const i=s===t;e.setAttribute("aria-selected",String(i)),e.setAttribute("tabindex",i?"0":"-1")}),this.#e.forEach((e,s)=>{e.hidden=s!==t}),this.#s=t,this.emit("lm-tab-change",{index:t,tab:this.#t[t]})}get activeIndex(){return this.#s}set activeIndex(t){t>=0&&t<this.#t.length&&this.#i(t)}}customElements.define("lm-tabs",LMTabs),document.addEventListener("toggle",n=>{const t=n.target;if(!t.matches("menu[popover]"))return;const e=document.querySelector(`[popovertarget="${t.id}"]`),s=()=>{const i=e.getBoundingClientRect();t.style.top=`${i.bottom}px`,t.style.left=`${i.left}px`};n.newState==="open"?(s(),window.addEventListener("scroll",s,!0),t._cleanup=()=>window.removeEventListener("scroll",s,!0),t.querySelector('[role="menuitem"]')?.focus(),e?.setAttribute("aria-expanded","true")):(t._cleanup?.(),e?.setAttribute("aria-expanded","false"),e?.focus())},!0),document.addEventListener("keydown",n=>{const t=n.target;if(!t.matches('[role="menuitem"]'))return;const e=t.closest("menu[popover]");if(!e?.matches(":popover-open"))return;const s=[...e.querySelectorAll('[role="menuitem"]')],i=s.indexOf(t);switch(n.key){case"ArrowDown":n.preventDefault(),s[(i+1)%s.length]?.focus();break;case"ArrowUp":n.preventDefault(),s[i-1<0?s.length-1:i-1]?.focus();break;case"Home":n.preventDefault(),s[0]?.focus();break;case"End":n.preventDefault(),s[s.length-1]?.focus();break}});class LMToast extends LMBase{#t=5e3;#e=null;static get observedAttributes(){return["duration","visible"]}init(){this.#t=parseInt(this.getAttribute("duration")||"5000",10),this.classList.add("animate-slide-in"),this.$$("[data-close]").forEach(t=>{t.addEventListener("click",this)}),this.hasAttribute("visible")&&this.show()}attributeChangedCallback(t,e,s){switch(t){case"visible":s!==null?this.show():this.close();break;case"duration":this.#t=parseInt(s||"5000",10);break}}onclick(t){t.target.closest("[data-close]")&&this.close()}show(){this.setAttribute("data-state","open"),this.hidden=!1,this.emit("lm-toast-open"),this.#t>0&&(this.#s(),this.#e=setTimeout(()=>this.close(),this.#t))}close(){this.#s(),this.setAttribute("data-state","closing"),this.removeAttribute("visible"),this.emit("lm-toast-close"),setTimeout(()=>{this.parentElement?.tagName==="LM-TOAST-CONTAINER"?this.remove():this.hidden=!0},150)}#s(){this.#e&&(clearTimeout(this.#e),this.#e=null)}cleanup(){this.#s()}}customElements.define("lm-toast",LMToast);class LMToastContainer extends LMBase{show({message:t,variant:e="",duration:s=5e3}){const i=document.createElement("lm-toast");return i.setAttribute("duration",String(s)),e&&i.setAttribute("data-variant",e),i.innerHTML=`
      <span>${t}</span>
      <button data-close aria-label="Close" style="background:none;border:none;cursor:pointer;padding:0;margin-left:auto;">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 6L6 18M6 6l12 12"/>
        </svg>
      </button>
    `,this.appendChild(i),requestAnimationFrame(()=>i.show()),i}clear(){this.$$("lm-toast").forEach(t=>t.close())}}customElements.define("lm-toast-container",LMToastContainer);
